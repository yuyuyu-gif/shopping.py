# å¿…è¦ãªãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ã‚¤ãƒ³ãƒãƒ¼ãƒˆ
import streamlit as st  # Webã‚¢ãƒ—ãƒªä½œæˆç”¨
import random  # ãƒ©ãƒ³ãƒ€ãƒ é¸æŠç”¨

# ãƒšãƒ¼ã‚¸è¨­å®š
st.set_page_config(
    page_title="ã‚ªãƒ¼ã‚¹ãƒˆãƒ©ãƒªã‚¢é£Ÿæè²·ã„ç‰©ãƒ¡ãƒ¢",  # ãƒ–ãƒ©ã‚¦ã‚¶ã®ã‚¿ãƒ–ã«è¡¨ç¤ºã•ã‚Œã‚‹ã‚¿ã‚¤ãƒˆãƒ«
    page_icon="ğŸ¦˜",                            # ãƒ–ãƒ©ã‚¦ã‚¶ã®ã‚¿ãƒ–ã«è¡¨ç¤ºã•ã‚Œã‚‹ã‚¢ã‚¤ã‚³ãƒ³
    layout="wide"                              # ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆã‚’ãƒ¯ã‚¤ãƒ‰ã«è¨­å®š
)

# ã‚¿ã‚¤ãƒˆãƒ«ã¨èª¬æ˜
st.title("ğŸ¦˜ ã‚ªãƒ¼ã‚¹ãƒˆãƒ©ãƒªã‚¢é£Ÿæè²·ã„ç‰©ãƒ¡ãƒ¢")  # ãƒ¡ã‚¤ãƒ³ã‚¿ã‚¤ãƒˆãƒ«
st.markdown("---")  # åŒºåˆ‡ã‚Šç·š
st.markdown("### ã‚ªãƒ¼ã‚¹ãƒˆãƒ©ãƒªã‚¢ã®ç¾å‘³ã—ã„é£Ÿæã‚„å•†å“ã‚’ãƒªã‚¹ãƒˆã‚¢ãƒƒãƒ—ã—ã‚ˆã†ï¼")  # ã‚µãƒ–ã‚¿ã‚¤ãƒˆãƒ«

# ===== ã‚ªãƒ¼ã‚¹ãƒˆãƒ©ãƒªã‚¢ã®é£Ÿæã‚µãƒ³ãƒ—ãƒ«ï¼ˆãƒªã‚¹ãƒˆï¼‰ =====
# ãƒªã‚¹ãƒˆï¼ˆlistï¼‰ï¼šè¤‡æ•°ã®ãƒ‡ãƒ¼ã‚¿ã‚’ç®¡ç†ã™ã‚‹ãƒ‡ãƒ¼ã‚¿æ§‹é€ 
# è§’æ‹¬å¼§[]ã§å›²ã‚“ã§ã€ã‚«ãƒ³ãƒåŒºåˆ‡ã‚Šã§è¦ç´ ã‚’ä¸¦ã¹ã‚‹
australian_foods = [
    "ğŸ¯ ãƒãƒŒã‚«ãƒãƒ‹ãƒ¼",
    "ğŸ¥© ãƒ“ãƒ¼ãƒ•ã‚¸ãƒ£ãƒ¼ã‚­ãƒ¼",
    "ğŸª ãƒ†ã‚£ãƒ ã‚¿ãƒ ",
    "ğŸ§€ ãƒ“ã‚¿ãƒ¼ãƒ“ã‚¿ãƒ¼",
    "ğŸ· ãƒ¯ã‚¤ãƒ³",
    "ğŸ¦˜ ã‚«ãƒ³ã‚¬ãƒ«ãƒ¼ãƒŸãƒ¼ãƒˆ",
    "ğŸŠ ã‚¯ãƒ­ã‚³ãƒ€ã‚¤ãƒ«ãƒŸãƒ¼ãƒˆ",
    "ğŸ¥œ ãƒã‚«ãƒ€ãƒŸã‚¢ãƒŠãƒƒãƒ„",
    "ğŸ« ãƒãƒ§ã‚³ãƒ¬ãƒ¼ãƒˆ",
    "â˜• ã‚³ãƒ¼ãƒ’ãƒ¼è±†",
    "ğŸ¥› ãƒŸãƒ«ã‚¯",
    "ğŸ§ˆ ãƒã‚¿ãƒ¼",
    "ğŸ¥– é£Ÿãƒ‘ãƒ³",
    "ğŸº xxxx Gold (ãƒ“ãƒ¼ãƒ«ï¼‰"
]

# ===== ã‚»ãƒƒã‚·ãƒ§ãƒ³çŠ¶æ…‹ã®åˆæœŸåŒ– =====
# session_stateï¼šãƒšãƒ¼ã‚¸ã‚’æ›´æ–°ã—ã¦ã‚‚ãƒ‡ãƒ¼ã‚¿ã‚’ä¿æŒã™ã‚‹Streamlitã®æ©Ÿèƒ½
# è²·ã„ç‰©ãƒªã‚¹ãƒˆã‚’ä¿å­˜ã™ã‚‹ãŸã‚ã®ç©ºã®ãƒªã‚¹ãƒˆã‚’ä½œæˆ
if 'shopping_list' not in st.session_state:
    st.session_state.shopping_list = []  # ç©ºã®ãƒªã‚¹ãƒˆã§åˆæœŸåŒ–

# å‰Šé™¤ç¢ºèªãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¡¨ç¤ºã™ã‚‹ãŸã‚ã®ãƒ•ãƒ©ã‚°
if 'clear_clicked' not in st.session_state:
    st.session_state.clear_clicked = False  # Falseã§åˆæœŸåŒ–

# ===== åŸºæœ¬çš„ãªä½¿ç”¨ä¾‹ =====
# è¾æ›¸ã®å ´åˆ
my_dict = {"name": "John", "age": 25}

# inæ¼”ç®—å­ï¼ˆå­˜åœ¨ã™ã‚‹ã‹ãƒã‚§ãƒƒã‚¯ï¼‰
if "name" in my_dict:
    print(f"åå‰: {my_dict['name']}")  # å­˜åœ¨ã™ã‚‹å ´åˆã®å‡¦ç†

# not inæ¼”ç®—å­ï¼ˆå­˜åœ¨ã—ãªã„ã‹ãƒã‚§ãƒƒã‚¯ï¼‰
if "city" not in my_dict:
    my_dict["city"] = "Tokyo"  # å­˜åœ¨ã—ãªã„å ´åˆã®å‡¦ç†

# ãƒªã‚¹ãƒˆã®å ´åˆ
my_list = ["apple", "banana", "orange"]

# inæ¼”ç®—å­ï¼ˆå­˜åœ¨ã™ã‚‹ã‹ãƒã‚§ãƒƒã‚¯ï¼‰
if "apple" in my_list:
    print("ã‚Šã‚“ã”ãŒè¦‹ã¤ã‹ã‚Šã¾ã—ãŸï¼")

# not inæ¼”ç®—å­ï¼ˆå­˜åœ¨ã—ãªã„ã‹ãƒã‚§ãƒƒã‚¯ï¼‰
if "grape" not in my_list:
    my_list.append("grape")  # å­˜åœ¨ã—ãªã„å ´åˆã®å‡¦ç†


# ===== ã‚µã‚¤ãƒ‰ãƒãƒ¼ã«ã‚ªãƒ¼ã‚¹ãƒˆãƒ©ãƒªã‚¢æƒ…å ± =====
with st.sidebar:  # ã‚µã‚¤ãƒ‰ãƒãƒ¼ã‚’ä½œæˆ
    st.header("ğŸ‡¦ğŸ‡º ã‚ªãƒ¼ã‚¹ãƒˆãƒ©ãƒªã‚¢æƒ…å ±")  # ã‚µã‚¤ãƒ‰ãƒãƒ¼ã®ãƒ˜ãƒƒãƒ€ãƒ¼
    st.markdown("""
    **ã‚ªãƒ¼ã‚¹ãƒˆãƒ©ãƒªã‚¢ã®ãŠã™ã™ã‚æ–™ç†:**
    - ğŸ¥© ãƒ“ãƒ¼ãƒ•ã‚¹ãƒ†ãƒ¼ã‚­
    - ğŸ¦˜ ã‚«ãƒ³ã‚¬ãƒ«ãƒ¼ã‚°ãƒªãƒ«
    - ğŸ¦ ãƒ­ãƒ–ã‚¹ã‚¿ãƒ¼
    - ğŸ¦ª ã‚ªã‚¤ã‚¹ã‚¿ãƒ¼
    - ğŸ– ãƒ©ãƒ ãƒãƒ§ãƒƒãƒ—
    """)

    # ===== ãƒ©ãƒ³ãƒ€ãƒ ãªã‚ªãƒ¼ã‚¹ãƒˆãƒ©ãƒªã‚¢æƒ…å ±ã‚’è¡¨ç¤º =====
    # ãƒªã‚¹ãƒˆï¼šè¤‡æ•°ã®æ–‡å­—åˆ—ã‚’æ ¼ç´
    australia_facts = [
        "ã‚ªãƒ¼ã‚¹ãƒˆãƒ©ãƒªã‚¢ã«ã¯ä¸–ç•Œæœ€å¤§ã®ã‚µãƒ³ã‚´ç¤ã€ã‚°ãƒ¬ãƒ¼ãƒˆãƒãƒªã‚¢ãƒªãƒ¼ãƒ•ãŒã‚ã‚Šã¾ã™ï¼",
        "ã‚ªãƒ¼ã‚¹ãƒˆãƒ©ãƒªã‚¢ã®å›½åœŸã¯æ—¥æœ¬ã®ç´„20å€ã®å¤§ãã•ã§ã™ï¼",
        "ã‚ªãƒ¼ã‚¹ãƒˆãƒ©ãƒªã‚¢ã«ã¯ä¸–ç•Œã§æœ€ã‚‚æ¯’ã®å¼·ã„ãƒ˜ãƒ“ğŸãŒã„ã¾ã™ï¼",
        "ã‚ªãƒ¼ã‚¹ãƒˆãƒ©ãƒªã‚¢ã®ç¾Šã®æ•°ã¯äººå£ã®ç´„3å€ã§ã™ï¼",
        "ã‚ªãƒ¼ã‚¹ãƒˆãƒ©ãƒªã‚¢ã«ã¯ä¸–ç•Œã§æœ€ã‚‚å¤ã„ç ‚æ¼ ãŒã‚ã‚Šã¾ã™ï¼",
        "ã€Œã‚¢ãƒã‚¿ãƒ¼ã€ã¨ã„ã†æ˜ ç”»ã®ã‚ªãƒ¼ãƒ—ãƒ‹ãƒ³ã‚°ã¯ã‚±ã‚¢ãƒ³ã‚ºã«ã‚ã‚‹ä¸–ç•Œæœ€å¤ã®ç†±å¸¯é›¨æ—ã§ã™ï¼",
        "ãƒ–ãƒªã‚¹ãƒ™ãƒ³ã®å·ã«ã¯ã‚µãƒ¡ãŒä½ã‚“ã§ã„ã¾ã™ğŸ¦ˆ",
        "ã‚±ã‚¢ãƒ³ã‚ºã®å·ã‚„ãƒ“ãƒ¼ãƒã«ã¯æ™‚ã€…ãƒ¯ãƒ‹ãŒã„ã¾ã™ğŸŠ"
    ]

    # ãƒœã‚¿ãƒ³ãŒæŠ¼ã•ã‚ŒãŸæ™‚ã®å‡¦ç†
    if st.button("ğŸ² ã‚ªãƒ¼ã‚¹ãƒˆãƒ©ãƒªã‚¢è±†çŸ¥è­˜"):
        # random.choice()é–¢æ•°ï¼šãƒªã‚¹ãƒˆã‹ã‚‰ãƒ©ãƒ³ãƒ€ãƒ ã«1ã¤ã®è¦ç´ ã‚’é¸æŠ
        st.info(random.choice(australia_facts))

# ===== ãƒ¡ã‚¤ãƒ³ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ =====
st.header("ğŸ“ è²·ã„ç‰©ãƒªã‚¹ãƒˆç®¡ç†")  # ãƒ¡ã‚¤ãƒ³ã®ãƒ˜ãƒƒãƒ€ãƒ¼

# æ–°ã—ã„ã‚¢ã‚¤ãƒ†ãƒ ã®å…¥åŠ›
# st.text_input()ï¼šãƒ†ã‚­ã‚¹ãƒˆå…¥åŠ›æ¬„ã‚’ä½œæˆ
new_item = st.text_input("æ–°ã—ã„ã‚¢ã‚¤ãƒ†ãƒ ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„:", placeholder="ä¾‹: ãƒãƒŒã‚«ãƒãƒ‹ãƒ¼")

# ===== è¿½åŠ ãƒœã‚¿ãƒ³ã®å‡¦ç† =====
# st.button()ï¼šãƒœã‚¿ãƒ³ã‚’ä½œæˆ
if st.button("â• ãƒªã‚¹ãƒˆã«è¿½åŠ "):
    # strip()ãƒ¡ã‚½ãƒƒãƒ‰ï¼šæ–‡å­—åˆ—ã®å‰å¾Œã®ç©ºç™½ã‚’å‰Šé™¤
    if new_item.strip():  # ç©ºã§ãªã„å ´åˆã®ã¿è¿½åŠ 
        # append()ãƒ¡ã‚½ãƒƒãƒ‰ï¼šãƒªã‚¹ãƒˆã®æœ«å°¾ã«è¦ç´ ã‚’è¿½åŠ 
        # ã“ã‚ŒãŒä»Šå›ã®å­¦ç¿’ãƒã‚¤ãƒ³ãƒˆã®1ã¤ï¼
        st.session_state.shopping_list.append(new_item.strip())
        st.success(f"âœ… '{new_item}' ã‚’ãƒªã‚¹ãƒˆã«è¿½åŠ ã—ã¾ã—ãŸï¼")
    else:
        st.warning("âš ï¸ ã‚¢ã‚¤ãƒ†ãƒ åã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚")

# ===== ã‚µãƒ³ãƒ—ãƒ«ã‚¢ã‚¤ãƒ†ãƒ ã‚’è¿½åŠ ã™ã‚‹ãƒœã‚¿ãƒ³ =====
if st.button("ğŸ¯ ã‚µãƒ³ãƒ—ãƒ«é£Ÿæã‚’è¿½åŠ "):
    # random.choice()é–¢æ•°ï¼šãƒªã‚¹ãƒˆã‹ã‚‰ãƒ©ãƒ³ãƒ€ãƒ ã«1ã¤ã®è¦ç´ ã‚’é¸æŠ
    sample_item = random.choice(australian_foods)
    # append()ãƒ¡ã‚½ãƒƒãƒ‰ï¼šãƒªã‚¹ãƒˆã«è¦ç´ ã‚’è¿½åŠ 
    st.session_state.shopping_list.append(sample_item)
    st.success(f"âœ… '{sample_item}' ã‚’ãƒªã‚¹ãƒˆã«è¿½åŠ ã—ã¾ã—ãŸï¼")


# ===== ã‚¯ãƒªã‚¢ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®è¡¨ç¤º =====
# ã‚»ãƒƒã‚·ãƒ§ãƒ³çŠ¶æ…‹ã‚’ä½¿ã£ã¦ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ç®¡ç†
# ã‚¯ãƒªã‚¢ãƒœã‚¿ãƒ³ãŒæŠ¼ã•ã‚ŒãŸã‚‰ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¡¨ç¤º
if st.session_state.clear_clicked:
    st.success("âœ… ãƒªã‚¹ãƒˆã‚’ã‚¯ãƒªã‚¢ã—ã¾ã—ãŸï¼")
    # ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¡¨ç¤ºã—ãŸã‚‰ãƒ•ãƒ©ã‚°ã‚’ãƒªã‚»ãƒƒãƒˆï¼ˆãƒœã‚¿ãƒ³ãŒæŠ¼ã•ã‚Œã¦ã„ãªã„çŠ¶æ…‹ã«ã™ã‚‹ï¼‰
    st.session_state.clear_clicked = False  # ãƒ•ãƒ©ã‚°ã‚’ãƒªã‚»ãƒƒãƒˆ

# ===== è²·ã„ç‰©ãƒªã‚¹ãƒˆã®è¡¨ç¤º =====
st.markdown("---")  # åŒºåˆ‡ã‚Šç·š
# 2ã¤ã®ã‚«ãƒ©ãƒ ã‚’ä½œæˆï¼ˆ3:1ã®æ¯”ç‡ï¼‰
col1, col2 = st.columns([3, 1])
with col1:
    st.header("ğŸ›’ ç¾åœ¨ã®è²·ã„ç‰©ãƒªã‚¹ãƒˆ")  # ãƒªã‚¹ãƒˆã®ãƒ˜ãƒƒãƒ€ãƒ¼
with col2:
    # len()é–¢æ•°ï¼šãƒªã‚¹ãƒˆã®è¦ç´ æ•°ã‚’å–å¾—
    st.metric("ã‚¢ã‚¤ãƒ†ãƒ æ•°", len(st.session_state.shopping_list))

# ===== ãƒªã‚¹ãƒˆãŒç©ºã®å ´åˆã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ =====
if len(st.session_state.shopping_list) == 0:
    st.info("ğŸ“ ã¾ã ã‚¢ã‚¤ãƒ†ãƒ ãŒã‚ã‚Šã¾ã›ã‚“ã€‚ä¸Šè¨˜ã®å…¥åŠ›æ¬„ã‹ã‚‰ã‚¢ã‚¤ãƒ†ãƒ ã‚’è¿½åŠ ã—ã¦ã¿ã¾ã—ã‚‡ã†ï¼")
else:
    # ===== foræ–‡ã‚’ä½¿ã£ã¦ãƒªã‚¹ãƒˆã®ä¸­èº«ã‚’é †ç•ªã«è¡¨ç¤º =====
    # enumerate()é–¢æ•°ï¼šãƒªã‚¹ãƒˆã®è¦ç´ ã¨ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚’åŒæ™‚ã«å–å¾—
    # enumerate(st.session_state.shopping_list, 1)ï¼šã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚’1ã‹ã‚‰é–‹å§‹
    # ã“ã‚ŒãŒä»Šå›ã®å­¦ç¿’ãƒã‚¤ãƒ³ãƒˆã®1ã¤ï¼
    for index, item in enumerate(st.session_state.shopping_list, 1):
        # 3ã¤ã®ã‚«ãƒ©ãƒ ã‚’ä½œæˆï¼ˆ0.1:0.6:0.3ã®æ¯”ç‡ï¼‰
        col1, col2, col3 = st.columns([0.1, 0.6, 0.3])

        with col1:
            st.write(f"**{index}.**")  # ç•ªå·ã‚’è¡¨ç¤º

        with col2:
            st.write(item)  # ã‚¢ã‚¤ãƒ†ãƒ åã‚’è¡¨ç¤º

        with col3:
            # st.popover()ï¼šãƒãƒƒãƒ—ã‚ªãƒ¼ãƒãƒ¼ï¼ˆå°ã•ãªãƒãƒƒãƒ—ã‚¢ãƒƒãƒ—ï¼‰ã‚’ä½œæˆ
            with st.popover("ğŸ—‘ï¸ å‰Šé™¤", help=f"ã€Œ{item}ã€ã‚’å‰Šé™¤"):
                st.write(f"ã€Œ{item}ã€ã‚’å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿ")
                if st.button("ã¯ã„", key=f"confirm_yes_{index}"):
                    # pop()ãƒ¡ã‚½ãƒƒãƒ‰ï¼šæŒ‡å®šã—ãŸã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã®è¦ç´ ã‚’å‰Šé™¤
                    st.session_state.shopping_list.pop(index - 1)
                    st.rerun()  # ãƒšãƒ¼ã‚¸ã‚’å†èª­ã¿è¾¼ã¿


# ===== ãƒªã‚¹ãƒˆã®æ“ä½œãƒœã‚¿ãƒ³ =====
if len(st.session_state.shopping_list) > 0:
    st.markdown("---")  # åŒºåˆ‡ã‚Šç·š
    # 2ã¤ã®ã‚«ãƒ©ãƒ ã‚’ä½œæˆ
    col1, col2 = st.columns(2)

    with col1:
        # ãƒªã‚¹ãƒˆã‚’ã‚¯ãƒªã‚¢ã™ã‚‹ãƒœã‚¿ãƒ³
        if st.button("ğŸ—‘ï¸ ãƒªã‚¹ãƒˆã‚’ã‚¯ãƒªã‚¢"):
            # clear()ãƒ¡ã‚½ãƒƒãƒ‰ï¼šãƒªã‚¹ãƒˆã®å…¨è¦ç´ ã‚’å‰Šé™¤
            st.session_state.shopping_list.clear()
            st.session_state.clear_clicked = True  # ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸è¡¨ç¤ºãƒ•ãƒ©ã‚°ã‚’è¨­å®š
            st.rerun()  # ãƒšãƒ¼ã‚¸ã‚’å†èª­ã¿è¾¼ã¿

    with col2:
        # ãƒªã‚¹ãƒˆã‚’ã‚³ãƒ”ãƒ¼ã™ã‚‹ãƒœã‚¿ãƒ³
        if st.button("ğŸ“‹ ãƒªã‚¹ãƒˆã‚’ã‚³ãƒ”ãƒ¼"):
            # ãƒªã‚¹ãƒˆã®è¦ç´ ã‚’æ–‡å­—åˆ—ã«å¤‰æ›
            # enumerate()é–¢æ•°ï¼šã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã¨è¦ç´ ã‚’åŒæ™‚ã«å–å¾—
            # join()ãƒ¡ã‚½ãƒƒãƒ‰ï¼šãƒªã‚¹ãƒˆã®è¦ç´ ã‚’æ”¹è¡Œã§çµåˆ
            list_text = "\n".join([f"{i+1}. {item}" for i, item in enumerate(st.session_state.shopping_list)])
            st.code(list_text)  # ã‚³ãƒ¼ãƒ‰ãƒ–ãƒ­ãƒƒã‚¯ã¨ã—ã¦è¡¨ç¤º
            st.info("ä¸Šè¨˜ã®ãƒªã‚¹ãƒˆã‚’ã‚³ãƒ”ãƒ¼ã—ã¦ä½¿ç”¨ã—ã¦ãã ã•ã„ï¼")

